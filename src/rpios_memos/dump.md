# 04: ダンプツール

- sd.imgの各要素をダンプするツールを作った

```
$ ./dump
./dump type[oslbid] [, arg1 [, arg2]]
 o: print disk layout
 s: print superblock
 l: print log block
 b: print bitmap
 i: print inode, arg1: 開始inum[. arg2: 終了inum[=開始inum]]
 d: print data, arg1: 開始セクタ番号, [arg2: セクタ数[=1]]

$ ./dump o
Boot      : 0x04100000 (1)
SuperBlock: 0x04100200 (1)
Log       : 0x04100400 (30)
INode     : 0x04104000 (200)
Bitmap    : 0x04107400 (5)
Data      : 0x04107e00

$ ./dump s
SUPER BLOCK:
 size     : 20000 (0x00004e20)
 nblocks  : 19937 (0x00004de1)
 ninode   : 200 (0x000000c8)
 nlog     : 30 (0x0000001e)
 logstart : 2 (0x00000002)
 bmapstart: 58 (0x0000003a)

$ ./dump l
LOG:
04100400: 0000 0000 0000 0000 0000 0000 0000 0000 ................
04100410: 0000 0000 0000 0000 0000 0000 0000 0000 ................
04100420: 0000 0000 0000 0000 0000 0000 0000 0000 ................
04100430: 0000 0000 0000 0000 0000 0000 0000 0000 ................
04100440: 0000 0000 0000 0000 0000 0000 0000 0000 ................
04100450: 0000 0000 0000 0000 0000 0000 0000 0000 ................
04100460: 0000 0000 0000 0000 0000 0000 0000 0000 ................
04100470: 0000 0000 0000 0000 0000 0000 0000 0000 ................

$ ./dump b
BITMAP:
04107400: ffff ffff ffff ffff ffff ffff ffff ffff ................
04107410: ffff ffff ffff ffff ffff ffff ffff ffff ................
04107420: ffff ffff ffff ffff ffff ffff ffff ffff ................
04107430: ffff ffff ffff ffff ffff ffff ffff ffff ................
04107440: ffff ffff ffff ffff ffff ffff ffff ffff ................
04107450: ff0f 0000 0000 0000 0000 0000 0000 0000 ................
04107460: 0000 0000 0000 0000 0000 0000 0000 0000 ................
04107470: 0000 0000 0000 0000 0000 0000 0000 0000 ................

$ ./dump i 1 2
INODE[1]: 0x04104040
 type : 0x0001 (DIR)
 major: 0x0000
 minor: 0x0000
 nlink: 0x0001
 size : 512 (0x00000200)
 addrs[00]: 63

INODE[2]: 0x04104080
 type : 0x0002 (FILE)
 major: 0x0000
 minor: 0x0000
 nlink: 0x0001
 size : 39104 (0x000098c0)
 addrs[00]: 64
 addrs[01]: 65
 addrs[02]: 66
 addrs[03]: 67
 addrs[04]: 68
 addrs[05]: 69
 addrs[06]: 70
 addrs[07]: 71
 addrs[08]: 72
 addrs[09]: 73
 addrs[10]: 74
 addrs[11]: 75

$ ./dump i 1
INODE[1]: 0x04104040
 type : 0x0001 (DIR)
 major: 0x0000
 minor: 0x0000
 nlink: 0x0001
 size : 512 (0x00000200)
 addrs[00]: 63

$ ./dump d 64
SECTOR: 64
04108000: 7f45 4c46 0201 0100 0000 0000 0000 0000 .ELF............
04108010: 0200 b700 0100 0000 7402 4000 0000 0000 ........t.@.....
04108020: 4000 0000 0000 0000 c094 0000 0000 0000 @...............
04108030: 0000 0000 4000 3800 0400 4000 1000 0f00 ....@.8...@.....
04108040: 0100 0000 0500 0000 0000 0000 0000 0000 ................
04108050: 0000 4000 0000 0000 0000 4000 0000 0000 ..@.......@.....
04108060: d060 0000 0000 0000 d060 0000 0000 0000 .`.......`......
04108070: 0010 0000 0000 0000 0100 0000 0600 0000 ................
04108080: a06f 0000 0000 0000 a07f 4000 0000 0000 .o........@.....
04108090: a07f 4000 0000 0000 5002 0000 0000 0000 ..@.....P.......
041080a0: 9808 0000 0000 0000 0010 0000 0000 0000 ................
041080b0: 51e5 7464 0600 0000 0000 0000 0000 0000 Q.td............
041080c0: 0000 0000 0000 0000 0000 0000 0000 0000 ................
041080d0: 0000 0000 0000 0000 0000 0000 0000 0000 ................
041080e0: 1000 0000 0000 0000 52e5 7464 0400 0000 ........R.td....
041080f0: a06f 0000 0000 0000 a07f 4000 0000 0000 .o........@.....
04108100: a07f 4000 0000 0000 6000 0000 0000 0000 ..@.....`.......
04108110: 6000 0000 0000 0000 0100 0000 0000 0000 `...............
04108120: fd7b bfa9 fd03 0091 fd7b c1a8 c003 5fd6 .............._.
04108130: f37b bfa9 f303 002a 3501 0094 3501 0094 .......*5...5...
04108140: 330c 0094 e003 132a bb09 0094 0000 0000 3......*........
04108150: 1f04 0071 cd08 0054 ff43 09d1 fd7b 00a9 ...q...T.C......
04108160: fd03 0091 f763 03a9 f803 01aa 3700 80d2 .....c......7...
04108170: f96b 04a9 197c 4093 f353 01a9 f55b 02a9 .k....@..S...[..
04108180: 3600 00b0 1f20 03d5 0100 8052 007b 77f8 6.... .....R....
04108190: 2e01 0094 f503 002a c004 f837 e143 0191 .......*...7.C..
041081a0: e003 152a 0240 80d2 e608 0094 1f00 0071 ...*.@.........q
041081b0: 6d02 0054 1f20 03d5 1404 0051 e047 0191 m..T. .....Q.G..
041081c0: dada 45f9 f343 0191 9402 008b 1f20 03d5 ..E..C....... ..
041081d0: 6016 4038 e103 1aaa a401 0094 9f02 13eb `.@8............
041081e0: 81ff ff54 e143 0191 e003 152a 0240 80d2 ...T.C.....*.@..
041081f0: d408 0094 1f00 0071 0cfe ff54 e003 152a .......q...T...*

$ ./dump d 64 2
SECTOR: 64
04108000: 7f45 4c46 0201 0100 0000 0000 0000 0000 .ELF............
04108010: 0200 b700 0100 0000 7402 4000 0000 0000 ........t.@.....
04108020: 4000 0000 0000 0000 c094 0000 0000 0000 @...............
04108030: 0000 0000 4000 3800 0400 4000 1000 0f00 ....@.8...@.....
04108040: 0100 0000 0500 0000 0000 0000 0000 0000 ................
04108050: 0000 4000 0000 0000 0000 4000 0000 0000 ..@.......@.....
04108060: d060 0000 0000 0000 d060 0000 0000 0000 .`.......`......
04108070: 0010 0000 0000 0000 0100 0000 0600 0000 ................
04108080: a06f 0000 0000 0000 a07f 4000 0000 0000 .o........@.....
04108090: a07f 4000 0000 0000 5002 0000 0000 0000 ..@.....P.......
041080a0: 9808 0000 0000 0000 0010 0000 0000 0000 ................
041080b0: 51e5 7464 0600 0000 0000 0000 0000 0000 Q.td............
041080c0: 0000 0000 0000 0000 0000 0000 0000 0000 ................
041080d0: 0000 0000 0000 0000 0000 0000 0000 0000 ................
041080e0: 1000 0000 0000 0000 52e5 7464 0400 0000 ........R.td....
041080f0: a06f 0000 0000 0000 a07f 4000 0000 0000 .o........@.....
04108100: a07f 4000 0000 0000 6000 0000 0000 0000 ..@.....`.......
04108110: 6000 0000 0000 0000 0100 0000 0000 0000 `...............
04108120: fd7b bfa9 fd03 0091 fd7b c1a8 c003 5fd6 .............._.
04108130: f37b bfa9 f303 002a 3501 0094 3501 0094 .......*5...5...
04108140: 330c 0094 e003 132a bb09 0094 0000 0000 3......*........
04108150: 1f04 0071 cd08 0054 ff43 09d1 fd7b 00a9 ...q...T.C......
04108160: fd03 0091 f763 03a9 f803 01aa 3700 80d2 .....c......7...
04108170: f96b 04a9 197c 4093 f353 01a9 f55b 02a9 .k....@..S...[..
04108180: 3600 00b0 1f20 03d5 0100 8052 007b 77f8 6.... .....R....
04108190: 2e01 0094 f503 002a c004 f837 e143 0191 .......*...7.C..
041081a0: e003 152a 0240 80d2 e608 0094 1f00 0071 ...*.@.........q
041081b0: 6d02 0054 1f20 03d5 1404 0051 e047 0191 m..T. .....Q.G..
041081c0: dada 45f9 f343 0191 9402 008b 1f20 03d5 ..E..C....... ..
041081d0: 6016 4038 e103 1aaa a401 0094 9f02 13eb `.@8............
041081e0: 81ff ff54 e143 0191 e003 152a 0240 80d2 ...T.C.....*.@..
041081f0: d408 0094 1f00 0071 0cfe ff54 e003 152a .......q...T...*
SECTOR: 65
04108200: c008 0094 f706 0091 ff02 19eb e1fb ff54 ...............T
04108210: 0000 8052 fd7b 40a9 f353 41a9 f55b 42a9 ...R..@..SA..[B.
04108220: f763 43a9 f96b 44a9 ff43 0991 c003 5fd6 .cC..kD..C...._.
04108230: 2000 00b0 13d4 45f9 e500 0094 0000 40b9  .....E.......@.
04108240: 157b 77f8 1403 40f9 ee00 0094 e303 15aa ......@.........
04108250: e403 00aa e203 14aa e003 13aa 2100 00b0 ............!...
04108260: 2100 0d91 3501 0094 e7ff ff17 0000 8052 !...5..........R
04108270: c003 5fd6 1d00 80d2 1e00 80d2 e003 0091 .._.............
04108280: 0100 0090 2100 0091 1fec 7c92 0100 0014 ....!...........
04108290: e203 00aa 2400 00f0 2300 00f0 2000 00f0 ....$...#... ...
041082a0: 84f0 47f9 0500 80d2 63e0 47f9 00ec 47f9 ..G.....c.G...G.
041082b0: 4184 40f8 b400 0014 4000 0090 00c0 0791 A.@.....@.......
041082c0: 4100 0090 21c0 0791 3f00 00eb c000 0054 A...!...?......T
041082d0: 2100 00f0 21e8 47f9 6100 00b4 f003 01aa !...!.G.a.......
041082e0: 0002 1fd6 c003 5fd6 4000 0090 00c0 0791 ......_.@.......
041082f0: 4100 0090 21c0 0791 2100 00cb 4200 80d2 A...!...!...B...
04108300: 21fc 4393 210c c29a c100 00b4 2200 00f0 !.C.!......."...
04108310: 42e4 47f9 6200 00b4 f003 02aa 0002 1fd6 B.G.b...........
04108320: c003 5fd6 fd7b bea9 fd03 0091 f30b 00f9 .._.............
04108330: 5300 0090 60c2 4739 4001 0035 2000 00f0 S...`.G9@..5 ...
04108340: 00dc 47f9 8000 00b4 4000 0090 0000 40f9 ..G.....@.....@.
04108350: 1f20 03d5 d9ff ff97 2000 8052 60c2 0739 . ...... ..R`..9
04108360: f30b 40f9 fd7b c2a8 c003 5fd6 dfff ff17 ..@......._.....
04108370: c003 5fd6 c003 5fd6 f353 a8a9 0226 80d2 .._..._..S...&..
04108380: f403 00aa e343 0191 f303 01aa e003 03aa .....C..........
04108390: 0100 8052 f57b 01a9 fe07 0094 e303 00aa ...R............
041083a0: 4000 0090 0100 80d2 1448 03f9 807a 61f8 @........H....a.
041083b0: 2104 0091 c0ff ffb5 5500 0090 b522 0891 !.......U...."..
041083c0: 800e 018b a006 00f9 1400 40f9 b402 00b5 ..........@.....
041083d0: 4000 0090 e16b 40f9 0100 01f9 e0ab 40f9 @....k@.......@.
041083e0: 6000 00b4 4100 0090 20fc 00f9 e043 40f9 `...A... ....C@.
041083f0: a01a 00f9 d300 00b5 e0a7 40f9 3300 00b0 ..........@.3...
```
